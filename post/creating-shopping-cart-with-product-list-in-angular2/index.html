<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    


    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="Creating shopping cart with product list in Angular2"/>
<meta name="twitter:description" content=""/>
<meta name="twitter:site" content="@benetisz"/>



  	<meta property="og:title" content="Creating shopping cart with product list in Angular2 &middot; Typical personal blog" />
  	<meta property="og:site_name" content="Typical personal blog" />
  	<meta property="og:url" content="https://benetis.me/post/creating-shopping-cart-with-product-list-in-angular2/" />
    
    
        
            <meta property="og:image" content="https://benetis.me/images/blog_cover_optimized_stars.jpg"/>
        
    

    
    <meta property="og:description" content="" />
  	<meta property="og:type" content="article" />
    <meta property="og:image" content="https://benetis.me/" />
    <meta property="article:published_time" content="2017-02-11T00:00:00Z" />

    
    <meta property="article:tag" content="Frontend" />
    
    <meta property="article:tag" content="Angular2" />
    
    

    <title>Creating shopping cart with product list in Angular2 &middot; Typical personal blog</title>

    
    <meta name="description" content="" />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://benetis.me/images/favicon.ico">
	  <link rel="apple-touch-icon" href="https://benetis.me/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="https://benetis.me/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="https://benetis.me/css/nav.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />

    

    
      
          <link href="https://benetis.me/index.xml" rel="alternate" type="application/rss+xml" title="Typical personal blog" />
      
      
    
    <meta name="generator" content="Hugo 0.19-DEV" />

    <link rel="canonical" href="https://benetis.me/post/creating-shopping-cart-with-product-list-in-angular2/" />

    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": ""
    },
    "author": {
        "@type": "Person",
        "name": "",
        
        "url": "https://benetis.me",
        "sameAs": [
            
            
             
             
             
             
             
            
        ]
    },
    "headline": "Creating shopping cart with product list in Angular2",
    "name": "Creating shopping cart with product list in Angular2",
    "wordCount":  2396 ,
    "timeRequired": "PT12M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": "en"
    },
    "url": "https://benetis.me/post/creating-shopping-cart-with-product-list-in-angular2/",
    "datePublished": "2017-02-11T00:00Z",
    "dateModified": "2017-02-11T00:00Z",
    
    "keywords": "Frontend, Angular2",
    "description": "",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://benetis.me/post/creating-shopping-cart-with-product-list-in-angular2/"
    }
}
    </script>
    


    

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-36419336-4', 'auto');
      ga('send', 'pageview');

    </script>

    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/themes/prism.min.css" />

    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="https://benetis.me/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
  
      <a class="menu-button icon-feed" href="https://benetis.me/index.xml">&nbsp;&nbsp;Subscribe</a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Creating shopping cart with product list in Angular2</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-02-11T00:00:00Z">
            Feb 11, 2017
          </time>
        
         
          <span class="post-tag small"><a href="https://benetis.me/tags/frontend/">#Frontend</a></span>
         
          <span class="post-tag small"><a href="https://benetis.me/tags/angular2/">#Angular2</a></span>
         
        </section>
    </header>

    <section class="post-content">
      

<h3 id="introduction">Introduction</h3>

<p>A common scenario - you want a product list with &ldquo;Add to cart&rdquo; functionality. Angular can do that - let&rsquo;s see how effective it is.</p>

<p>You can find code in this repository - <a href="https://github.com/benetis/didactic-computing-machine/tree/master/ng/small-commercial-spa">github</a></p>

<h3 id="goal">Goal</h3>

<p><strong>1. Product list with images</strong>, color filter, names and currency. We want to create something similar that H&amp;M has.</p>

<p><strong>2. Details of item</strong></p>

<p><strong>3. Shopping cart view</strong></p>

<p>To view the details and remove items from it. You can see an image below.</p>

<p><img src="https://benetis.me/images/2017/02/Screen-Shot-2017-02-11-at-11.16.27.png" alt="http://i64.tinypic.com/v48aya.png" /></p>

<p><img src="https://benetis.me/images/2017/02/Screen-Shot-2017-02-11-at-11.22.09.png" alt="Shopping cart" /></p>

<p>Of course we want everything to be responsive and made with Angular. We will skip unit tests.</p>

<h3 id="setting-up-the-project">Setting up the project</h3>

<p>Angular CLI seems mature enough for our needs. Let&rsquo;s install it globally.</p>

<p><code>npm install -g @angular/cli</code></p>

<p>Let&rsquo;s create project</p>

<p><code>ng new small-commercial-application</code></p>

<h3 id="project-structure">Project structure</h3>

<p>Now for the project structure we want our routes to be lazy loaded. A convention is that lazy routed folders should start with <code>+</code>.</p>

<p>We can say that we will need two folders - for landing page and for cart page.</p>

<p><img src="https://benetis.me/images/2017/02/Screen-Shot-2017-02-11-at-14.38.58.png" alt="" /></p>

<p>Also while we are at it - let&rsquo;s create our routes file <code>app.routes.ts</code> where we will define root module routes. We will make these routes <em>lazy</em> a little bit later</p>

<pre><code class="language-typescript">
export const routes: Routes = [
  {
    path: '',
    pathMatch: 'full',
    component: LandingComponent
  }
];
</code></pre>

<p>Ignore the part where <code>LandingComponent</code> is red. We will import it later.</p>

<p>What is left for routes is to include them into our <code>app.module.ts</code></p>

<pre><code class="language-typescript">@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule,
    FormsModule,
    HttpModule,
    LandingModule,
    RouterModule.forRoot(routes)
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }
</code></pre>

<p>We also will need to include <code>LandingModule</code> for now since we directly load it on <code>/</code>. Later we will change this.</p>

<h3 id="products-list">Products list</h3>

<p>I always like to start from the data. How will our data look?</p>

<p>Each item will have some data and it can have multiple colors assigned to it.</p>

<pre><code class="language-typescript">export type ItemColor = 'blue' | 'green' | 'gray';

export interface Item {
  id?: number;
  name?: string;
  price?: number;
  currency?: string;
  colors?: ItemColor[];
  picture?: string;
}
</code></pre>

<p>This interface should be a good starting point. <code>ItemColor</code> defines available colors which can be assigned to product. Sure they can be dynamic, but let&rsquo;s keep our scope limited</p>

<p>Second, let&rsquo;s think what kind of components we will need.</p>

<ul>
<li><strong>Item</strong> which will represent a single product in a list</li>
<li><strong>ItemList</strong> which will represent list of Items in a list</li>
<li><strong>Landing</strong> which will hold our <strong>ItemList</strong> and <strong>ItemFilter</strong> components</li>
</ul>

<p>For components creation we can utilise <code>Angular CLI</code>.</p>

<ul>
<li><code>cd +landing</code></li>
<li><code>mkdir components</code></li>
<li><code>ng g component item</code> //will generate component inside a folder. Suits us perfectly</li>
<li><code>ng g component item-list</code></li>
</ul>

<h4 id="item-component">Item component</h4>

<p>Our <code>Item</code> component will need to display an image. Instead of getting images from some json file (encoded) we will do it lazy way - just use icon of image.</p>

<p><img src="https://benetis.me/images/2017/02/Screen-Shot-2017-02-11-at-15.02.26.png" alt="" /></p>

<p>Just a dumb component where all info is passed to it. Because of this we can utilise <code>ChangeDetection.OnPush</code> which will increase our performance due to fact that it only needs to do changes when input data is changed</p>

<p><code>item.component.ts</code></p>

<pre><code class="language-typescript">@Component({
  selector: 'spa-item',
  templateUrl: './item.component.html',
  styleUrls: ['./item.component.css'],
  changeDetection: ChangeDetectionStrategy.OnPush
})
export class ItemComponent {

  @Input() public id: number;
  @Input() public name: string;
  @Input() public price: number;
  @Input() public currency: string;

  public getCurrency(): string {
    return 'USD';
  }
}
</code></pre>

<p><code>item.component.html</code></p>

<pre><code class="language-html">&lt;div class=&quot;item-image&quot;&gt;
  &lt;i class=&quot;fa fa-picture-o fa-6&quot;&gt;&lt;/i&gt;
&lt;/div&gt;
&lt;div class=&quot;item-name&quot;&gt;{{name}}&lt;/div&gt;
&lt;div class=&quot;item-price&quot;&gt;
  {{getCurrency()}}{{price}}
&lt;/div&gt;
</code></pre>

<p><code>item.component.css</code></p>

<pre><code class="language-css">.item-image {
  font-size: 6em;
  color: lightgray;
}

.item-price {
  font-weight: bold;
}
</code></pre>

<h4 id="itemlist-component">ItemList component</h4>

<p>Okay - so we will want to overate a list of data and for each of the &ldquo;row&rdquo; display our <code>Item</code>. Pretty simple we can achieve this using <code>ngFor</code></p>

<pre><code class="language-html">&lt;spa-item *ngFor=&quot;let item of items&quot;
          [name]=&quot;item.name&quot;
          [price]=&quot;item.price&quot;
          [currency]=&quot;item.currency&quot;
&gt;&lt;/spa-item&gt;
</code></pre>

<p>At this moment this is how our application looks (with some mock data passed down from <code>Landing</code> component)</p>

<p><img src="https://benetis.me/images/2017/02/Screen-Shot-2017-02-11-at-15.15.34.png" alt="" /></p>

<p>Continuing - we want a grid view of our items. This is where <code>flexbox</code> can help us.</p>

<p><code>updated list-item.component.html</code></p>

<pre><code class="language-html">&lt;div class=&quot;list-items&quot;&gt;
  &lt;div class=&quot;list-item&quot; *ngFor=&quot;let item of items&quot;&gt;
    &lt;spa-item
      [name]=&quot;item.name&quot;
      [price]=&quot;item.price&quot;
      [currency]=&quot;item.currency&quot;&gt;
    &lt;/spa-item&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<p><code>list-item.component.css</code></p>

<pre><code class="language-css">.list-items {
  display: flex;

  justify-content: center;

  flex-flow: row wrap;
  align-content: flex-end;
}

.list-item {
  margin-left: 10px;
  margin-right: 10px;
}
</code></pre>

<p>This is the result:</p>

<p><img src="https://benetis.me/images/2017/02/Feb-11-2017-15-25-06.gif" alt="resizing_browser_columns_wrap" /></p>

<p>Aesthetically not the most pleasing look - but wrapping works as we expected. We can add more padding later.</p>

<h4 id="filters">Filters</h4>

<p>Each picture has a color assigned to it. What we want is to filter our items by such filter. This component is more complex than the others, because of it need to interact. Good rule to go by when filtering data - keep original data structures and just transform it as you go.</p>

<p>As always let&rsquo;s start with new component:</p>

<p><code>ng g component ItemFilter</code></p>

<p>==Now we will want our <code>ItemList</code> component to handle the actual data filtering. This this let us decouple logic early on and benefit us in the future. Especially if we will tie ngrx or similar store management into our application.==</p>

<p>==So our <code>ItemFilter</code> should only contain UI presentation logic of turning on/off, display filters. Not interaction with data.==</p>

<p><code>item-filter.component.ts</code></p>

<pre><code class="language-typescript">import {ChangeDetectionStrategy, Component, EventEmitter, Input, OnInit, Output} from '@angular/core';
import {ItemColor, ItemFilter} from '../../classes/item';

@Co mponent({
  selector: 'spa-item-filters',
  templateUrl: './item-filter.component.html',
  styleUrls: ['./item-filter.component.css'],
  changeDetection: ChangeDetectionStrategy.OnPush
})
export class ItemFilterComponent implements OnInit {

  @Input() availableFilters: ItemFilter[] = [];
  @Input() activatedFilters: ItemFilter[] = [];
  @Output() activeFilters: EventEmitter&lt;ItemFilter[]&gt; = new EventEmitter&lt;ItemFilter[]&gt;();

  constructor() {
  }

  ngOnInit() {
  }

  public filterColor(color: ItemColor): string {
    const colors = {
      'blue': 'blue',
      'green': 'green',
      'gray': 'gray'
    };
    return colors[color];
  }

  public filterActive(filter: ItemFilter): boolean {
    return this.activatedFilters.find(_ =&gt; _.color === filter.color) != null;
  }

  public changeFilterStatus(filter: ItemFilter) {
    this.activeFilters.emit([filter]);
  }
}
</code></pre>

<p>You can see that we are getting active and available filters through inputs and outputting changed filters through outputs.</p>

<p><code>item-filter.component.html</code></p>

<pre><code class="language-html">&lt;div class=&quot;filter-list&quot;&gt;
  &lt;div *ngFor=&quot;let filter of availableFilters&quot;&gt;
    &lt;div class=&quot;filter-box&quot;
         [ngStyle]=&quot;{ 'background-color': filterColor(filter.color)}&quot;
         [ngClass]=&quot;{ 'filter-activated': filterActive(filter)}&quot;
         (click)=&quot;changeFilterStatus(filter)&quot;
    &gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<p>We also utilise <code>ngStyle</code> directive to set background color of filter. We do this for better maintainability in case we will want to make our filters dynamic.</p>

<p><code>item-filter.component.css</code></p>

<pre><code class="language-css">.filter-box {
  width: 1em;
  height: 1em;
  margin: 0.2em;
}

.filter-list {
  display: flex;
  flex-direction: row-reverse;
}

.filter-activated {
  border: 3px red solid;
}
</code></pre>

<p>Now for integration with <code>ItemList</code></p>

<p><code>item-list.component.html</code></p>

<pre><code class="language-html">&lt;div class=&quot;list-filter&quot;&gt;
  &lt;spa-item-filters
    [availableFilters]=&quot;filters&quot;
    [activatedFilters]=&quot;activeFilters&quot;
    (activeFilters)=&quot;updateActivatedFilters($event)&quot;
  &gt;&lt;/spa-item-filters&gt;
&lt;/div&gt;
&lt;div class=&quot;list-items&quot;&gt;
  &lt;div class=&quot;list-item&quot; *ngFor=&quot;let item of itemsAfterFilter()&quot;&gt;
    &lt;spa-item
      [name]=&quot;item.name&quot;
      [price]=&quot;item.price&quot;
      [currency]=&quot;item.currency&quot;&gt;
    &lt;/spa-item&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<p>We grab our items from the function <code>itemsAfterFilter()</code> so we can filter the data according to active filters</p>

<p><code>item-list.component.ts</code></p>

<pre><code class="language-typescript">import {ChangeDetectionStrategy, Component, Input, OnInit} from '@angular/core';
import {Item, ItemFilter} from '../../classes/item';

@Component({
  selector: 'spa-item-list',
  templateUrl: './item-list.component.html',
  styleUrls: ['./item-list.component.css'],
  changeDetection: ChangeDetectionStrategy.OnPush

})
export class ItemListComponent implements OnInit {

  @Input() public items: Item[] = [];

  public readonly filters: ItemFilter[] = [
    &lt;ItemFilter&gt;{color: 'blue'},
    &lt;ItemFilter&gt;{color: 'green'},
    &lt;ItemFilter&gt;{color: 'gray'},
  ];

  public activeFilters: ItemFilter[] = [];

  constructor() {
  }

  ngOnInit() {
  }

  public itemsAfterFilter(): Item[] {
    return this.items.filter((item: Item) =&gt; {
      const matchesActiveFilter: boolean = this.activeFilters.reduce((prev, curr) =&gt; {
        if (item.colors.includes(curr.color)) {
          return prev &amp;&amp; true;
        } else {
          return false;
        }
      }, true);

      return matchesActiveFilter;
    });
  }

  public updateActivatedFilters(filters: ItemFilter[]) {
    this.activeFilters = filters;
  }
}
</code></pre>

<p>Simple filter function with a little more complex reduce function inside of it does the job perfectly. Should fit most cases and be easy to refactor.</p>

<p>Let&rsquo;s see how our application looks.</p>

<p><img src="https://benetis.me/images/2017/02/Feb-11-2017-19-50-15.gif" alt="" /></p>

<h4 id="item-details">Item details</h4>

<p>Clicking on item name should take us to another page where it&rsquo;s details and &ldquo;Add to cart&rdquo; button is displayed.</p>

<p>Also at this point it makes sense to change <code>Item</code> to <code>Product</code> in our application just to avoid further confusion ahead. We don&rsquo;t want our naming to be confusing us.</p>

<p>Next - let&rsquo;s extract our products mock data from component to a separate service. Inject the service in app component. We are doing this so we can add another function to it which will return a specific product by id (which we will need for details).</p>

<p>==Later in the post we will refactor this service to serve observable instead of plain arrays to reflect real world application better==</p>

<p><code>products.service.ts</code></p>

<pre><code class="language-typescript">import {Injectable} from '@angular/core';
import {Product} from '../classes/product';
@Injectable()
export class ProductsService {
  public getProducts(): Product[] {
    return this.products();
  }

  public getProduct(id: number): Product {
    return this
      .products()
      .find((item: Product) =&gt; {
        return item.id === id;
      });
  }

  private products(): Product[] {
    return &lt;Product[]&gt;[
      &lt;Product&gt;{id: 1, name: 'Blue item', price: 123.09, colors: ['blue']},
      &lt;Product&gt;{id: 2, name: 'Green and gray', price: 99.09, colors: ['green', 'gray']},
      &lt;Product&gt;{id: 3, name: 'Green item', price: 99.09, colors: ['green']},
      &lt;Product&gt;{id: 4, name: 'Blue and gray', price: 99.09, colors: ['blue', 'gray']},
      &lt;Product&gt;{id: 5, name: 'Green and blue', price: 99.09, colors: ['green', 'blue']},
      &lt;Product&gt;{id: 6, name: 'Green and blue', price: 99.09, colors: ['green', 'blue']},
      &lt;Product&gt;{id: 7, name: 'Gray', price: 99.09, colors: ['gray']},
      &lt;Product&gt;{id: 8, name: 'Blue', price: 99.09, colors: ['blue']},
      &lt;Product&gt;{id: 9, name: 'All colors', price: 99.09, colors: ['gray', 'blue', 'green']},
    ];
  }
}
</code></pre>

<p>Next up - fixing the routes.</p>

<p>Okay so first <code>app.routes.ts</code></p>

<pre><code class="language-typescript">import {Routes, RouterModule} from '@angular/router';

export const routes: Routes = [
  {
    path: '',
    pathMatch: 'full',
    redirectTo: 'products'
  },
  {
    path: 'products',
    loadChildren: './+products/products.module#ProductsModule'
  }
];
</code></pre>

<p><code>products.routes.ts</code></p>

<pre><code class="language-typescript">import {Routes} from '@angular/router';
import {ProductsComponent} from './products.component';
import {ItemDetailsComponent} from './components/product-details/product-details.component';

export const routes: Routes = [
  {
    path: '',
    pathMatch: 'full',
    redirectTo: 'list'
  },
  {
    path: 'list',
    component: ProductsComponent
  },
  {
    path: 'details/:id',
    component: ItemDetailsComponent
  }
];
</code></pre>

<p>Let&rsquo;s go through the code. In app routes we lazy load the products module. In products routes we display list as default routes and also route to catch details with <code>:id</code>. So when user will click on item in products list - it will redirect to details page using that <code>id</code>.</p>

<p><code>product-details.ts</code></p>

<pre><code class="language-typescript">import {Component, OnDestroy, OnInit} from '@angular/core';
import {ActivatedRoute} from '@angular/router';
import {ProductsService} from '../../../services/products.service';
import {Product} from '../../../classes/product';

@Component({
  selector: 'spa-product-details',
  templateUrl: 'product-details.component.html',
  styleUrls: ['product-details.component.css']
})
export class ItemDetailsComponent implements OnInit {
  public product: Product = {};

  constructor(private route: ActivatedRoute
    , private productsService: ProductsService) {
  }

  ngOnInit() {
    this.route.params.subscribe(params =&gt; {
      const id = +params['id'];
      this.product = this.productsService.getProduct(id);
    });
  }

}
</code></pre>

<p>Subscribe to route and according to id - fetch the wanted product details. As for displaying them - let&rsquo;s use the same Product component and add needed additional info.</p>

<p><code>product-details.component.html</code></p>

<pre><code class="language-html">&lt;div class=&quot;product-details&quot;&gt;
  &lt;div class=&quot;product&quot;&gt;
    &lt;spa-product [name]=&quot;product.name&quot;
                 [size]=&quot;'3'&quot;
                 [price]=&quot;product.price&quot;
    &gt;&lt;/spa-product&gt;
    &lt;div class=&quot;color-list&quot;&gt;
      &lt;div *ngFor=&quot;let color of product.colors&quot;
           class=&quot;color-box&quot;
           [ngStyle]=&quot;{'background-color': color}&quot;
      &gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<p>As a side quest let&rsquo;s add a back button.</p>

<p>At top of the <code>product-details.component.html</code></p>

<pre><code class="language-html">&lt;div class=&quot;nav-bar&quot;&gt;
  &lt;a routerLink=&quot;/&quot;&gt;Back&lt;/a&gt;
&lt;/div&gt;
</code></pre>

<p>Yep - that simple.</p>

<h3 id="shopping-cart">Shopping Cart</h3>

<p>Cart is a place where items will be placed. A good place to start is with cart service which can be injected into app and be utilised to keep track of what is in it.</p>

<p>Let&rsquo;s make use of <code>BehaviorSubject</code>. It can be used in so many places that we can write a blog post of it own. As for now - think of it as <code>Subject</code> which hold last value. So when we subscribe - we get what it holds.</p>

<p><code>cart.service.ts</code></p>

<pre><code class="language-typescript">import {Injectable} from '@angular/core';
import {Product} from '../classes/product';
import {BehaviorSubject, Observable, Subject, Subscriber} from 'rxjs';
import {of} from 'rxjs/observable/of';
@Injectable()
export class CartService {
  private itemsInCartSubject: BehaviorSubject&lt;Product[]&gt; = new BehaviorSubject([]);
  private itemsInCart: Product[] = [];

  constructor() {
    this.itemsInCartSubject.subscribe(_ =&gt; this.itemsInCart = _);
  }

  public addToCart(item: Product) {
    this.itemsInCartSubject.next([...this.itemsInCart, item]);
  }

  public getItems(): Observable&lt;Product[]&gt; {
    return this.itemsInCartSubject;
  }
}
</code></pre>

<p>We push new items to subject and let our application parts subscribe to it.</p>

<p><code>shopping-cart-component.ts</code></p>

<pre><code class="language-typescript">import {Component, OnInit} from '@angular/core';
import {CartService} from '../../../services/cart.service';
import {Product} from '../../../classes/product';
import {Observable} from 'rxjs';
import {of} from 'rxjs/observable/of';

@Component({
  selector: 'spa-shopping-cart',
  templateUrl: './shopping-cart.component.html',
  styleUrls: ['./shopping-cart.component.css']
})
export class ShoppingCartComponent implements OnInit {

  public shoppingCartItems$: Observable&lt;Product[]&gt; = of([]);
  public shoppingCartItems: Product[] = [];

  constructor(private cartService: CartService) {
    this.shoppingCartItems$ = this
      .cartService
      .getItems();

    this.shoppingCartItems$.subscribe(_ =&gt; this.shoppingCartItems = _);
  }

  ngOnInit() {
  }

}
</code></pre>

<p>At this moment all added items can be visible to shopping cart. But what we are missing - is the cool feature of reactive programming - we don&rsquo;t see how adding items reflects other application states (although it happens behind the curtains).</p>

<p>We can show that by adding a number near shopping cart which indicates how many items we have in our cart. This way when we add new items that number will reflect our cart size.</p>

<p><code>app.component.ts</code></p>

<pre><code class="language-typescript"> public shoppingCartItems$: Observable&lt;Product[]&gt;;

  constructor(public location: Location
  , private cartService: CartService) {

    this.shoppingCartItems$ = this
      .cartService
      .getItems();

    this.shoppingCartItems$.subscribe(_ =&gt; _);
  }
</code></pre>

<pre><code class="language-html">    &lt;i class=&quot;fa fa-shopping-cart&quot;&gt;{{(shoppingCartItems$ | async).length}}&lt;/i&gt;
</code></pre>

<p>Let&rsquo;s see how it looks:</p>

<p><img src="https://benetis.me/images/2017/02/Feb-12-2017-15-06-46.gif" alt="" /></p>

<p>Okay 3 major things are left:</p>

<ul>
<li>Total sum in shopping cart</li>
<li>Delete button to remove item from shopping cart</li>
<li>Items that are in shopping cart should be removed from product list.</li>
</ul>

<h4 id="total-sum-in-shopping-cart">Total sum in shopping cart</h4>

<p>This one is easy. Let&rsquo;s add some magic of <code>RxJs</code> in our <code>cart.service.ts</code> and be done with it.</p>

<pre><code class="language-typescript">  public getTotalAmount(): Observable&lt;number&gt; {
    return this.itemsInCartSubject.map((items: Product[]) =&gt; {
      return items.reduce((prev, curr: Product) =&gt; {
        return prev + curr.price;
      }, 0);
    });
  }
</code></pre>

<p>This will return us an Observable to which we can subscribe and get our total.</p>

<h4 id="delete-button-to-remove-items-from-shopping-cart">Delete button to remove items from shopping cart</h4>

<p>Again - just an additional function in <code>cart.service</code> and button in shopping cart.</p>

<pre><code class="language-typescript">  public removeFromCart(item: Product) {
    const currentItems = [...this.itemsInCart];
    const itemsWithoutRemoved = currentItems.filter(_ =&gt; _.id !== item.id);
    this.itemsInCartSubject.next(itemsWithoutRemoved);
  }
</code></pre>

<h4 id="adding-product-to-cart-removes-it-from-product-list">Adding product to cart removes it from product list</h4>

<p>This one is also pretty easy one since we have decoupled our app.</p>

<p>Inject cart service into our products component. subscribe to our cart items and filter items passed to <code>ItemList</code> to remove those we have added. Yep - that easy.</p>

<pre><code class="language-typescript">  this.cartService
      .getItems()
      .subscribe((items: Product[]) =&gt; {
      // remove items that are in our cart
        const allItems = this.items;
        this.items = allItems.filter(_ =&gt; {
          return !this.itemIsInCart(_, items);
        });
      });
  }

  private itemIsInCart(item: Product, cart: Product[]): boolean {
    return cart.find(_ =&gt; _.id === item.id) != null;
  }
</code></pre>

<p>And a magical <code>this.router.navigateByUrl('/');</code> to <code>addToCart</code> function will redirect user back to products list when he has added an item.</p>

<p>As we went by with tasks. I had to do a bit of refactoring due to changes in our application. For example products service function were transformed into observables to represent real world data. (We don&rsquo;t know when it will come and form where)</p>

<p>Ok let&rsquo;s see how it works.</p>

<p><img src="https://benetis.me/images/2017/02/Feb-12-2017-19-04-41.gif" alt="" /></p>

<p>At this moment we have few problems left:</p>

<ul>
<li>No look n feel</li>
<li>You cannot disable filters</li>
<li>You cannot choose a color when you are adding an item to shopping bag</li>
</ul>

<p>But IMHO that is enough for now.</p>

<p>You can find code here - <a href="https://github.com/benetis/didactic-computing-machine/tree/master/ng/small-commercial-spa">https://github.com/benetis/didactic-computing-machine/tree/master/ng/small-commercial-spa
</a></p>

<h3 id="feedback">Feedback</h3>

<p>If you have any suggestions - I am eagerly waiting for feedback. <a href="https://benetis.me/post/contact-me/">https://benetis.me/post/contact-me/</a></p>

    </section>


  <footer class="post-footer">


    

    





<section class="author">
  <h4><a href="https://benetis.me/">Žygimantas Benetis</a></h4>
  
  <p>Read <a href="https://benetis.me/">more posts</a> by this author.</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">Kaunas, Lithuania</span>
    <span class="author-link icon-link"><a href="https://benetis.me">https://benetis.me</a></span>
  </div>
</section>



    
<section class="share">
  <h4>Share this post</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=Creating%20shopping%20cart%20with%20product%20list%20in%20Angular2&nbsp;-&nbsp;Typical%20personal%20blog&amp;url=https%3a%2f%2fbenetis.me%2fpost%2fcreating-shopping-cart-with-product-list-in-angular2%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fbenetis.me%2fpost%2fcreating-shopping-cart-with-product-list-in-angular2%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fbenetis.me%2fpost%2fcreating-shopping-cart-with-product-list-in-angular2%2f&amp;description=Creating%20shopping%20cart%20with%20product%20list%20in%20Angular2"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=https%3a%2f%2fbenetis.me%2fpost%2fcreating-shopping-cart-with-product-list-in-angular2%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    




  </footer>
</article>

</main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Typical personal blog</a> All rights reserved - 2017</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="https://benetis.me/js/jquery.js"></script>
    <script type="text/javascript" src="https://benetis.me/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://benetis.me/js/index.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/prism.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/components/prism-typescript.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/components/prism-haskell.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.6.0/components/prism-javascript.min.js"></script>
    
</body>
</html>

